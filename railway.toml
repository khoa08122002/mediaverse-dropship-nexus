[build]
builder = "nixpacks"
buildCommand = "npm install && npx prisma generate && npm run build:backend"

[deploy]
startCommand = "npx prisma migrate deploy && npm run start"
healthcheckPath = "/api/health"
healthcheckTimeout = 180
restartPolicyType = "on_failure"
numReplicas = 1
healthcheckInterval = 30

[deploy.envs]
NODE_ENV = "production"
PORT = "3002"
DATABASE_URL = "${DATABASE_URL}"
JWT_SECRET = "${JWT_SECRET}" 